# Escudos2




# === Utilidades ===
X_AXIS=App.Vector(1,0,0);Y_AXIS=App.Vector(0,1,0);Z_AXIS=App.Vector(0,0,1)
rot_to_x=lambda:App.Rotation(Y_AXIS,90)
def add_obj(s,n): o=doc.addObject("Part::Feature",n); o.Shape=s; return o
def color(o,rgb): 
    if hasattr(o,"ViewObject"): o.ViewObject.ShapeColor=rgb
    return o
def cyl_x(d,L,cx=0,cy=0,cz=0): s=Part.makeCylinder(d/2.0,L); s.Placement=App.Placement(App.Vector(cx-L/2.0,cy,cz),rot_to_x()); return s
def cone_x(d1,d2,L,cx=0,cy=0,cz=0): s=Part.makeCone(max(d1/2.0,1.0),max(d2/2.0,1.0),L); s.Placement=App.Placement(App.Vector(cx-L/2.0,cy,cz),rot_to_x()); return s
def box_x(l,w,h,cx=0,cy=0,cz=0): b=Part.makeBox(l,w,h); b.Placement=App.Placement(App.Vector(cx-l/2.0,cy-w/2.0,cz-h/2.0),App.Rotation()); return b

# === Escudo Parker multilayer ===
def parker_shield_cyl(cx, diam, face_th=10.0, foam_th=120.0, coat_th=2.0, uhtc_t=10.0,
                      sup_L=280.0, sup_d1=900.0, sup_d2=600.0):
    R=diam/2.0
    cx0=cx+sup_L+(face_th*2+foam_th+coat_th)/2.0
    back_cc=cyl_x(diam,face_th,cx=cx0-(foam_th/2+face_th/2+coat_th/2))
    core=cyl_x(diam-10.0,foam_th,cx=cx0)
    front_cc=cyl_x(diam,face_th,cx=cx0+(foam_th/2+face_th/2))
    coat=cyl_x(diam,coat_th,cx=cx0+(foam_th/2+face_th+coat_th/2))
    torus=Part.makeTorus(R-6.0,uhtc_t); torus.Placement=App.Placement(App.Vector(cx0,0,0),App.Rotation(Y_AXIS,90))
    sup=cone_x(sup_d1,sup_d2,sup_L,cx=cx+sup_L/2.0)
    fused=back_cc.fuse(core).fuse(front_cc).fuse(coat).fuse(torus).fuse(sup).removeSplitter()
    return add_obj(fused,"Parker_Shield")

